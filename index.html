<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luary Shop | Semijoias & Presentes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --navy: #1a2a3a; --gold: #c5a059; --bg: #fdfdfd; }
        body { font-family: 'Montserrat', sans-serif; background: var(--bg); color: var(--navy); }
        .serif { font-family: 'Playfair Display', serif; }
        .card-luary { background: #fff; border-radius: 15px; border: 1px solid #eee; transition: 0.3s; overflow: hidden; height: 100%; display: flex; flex-direction: column; }
        .card-luary:hover { border-color: var(--gold); transform: translateY(-5px); }
        .img-box { width: 100%; aspect-ratio: 1/1; overflow: hidden; background: #f9f9f9; }
        .img-box img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .btn-add { background: var(--navy); color: #fff; width: 100%; padding: 10px; border-radius: 8px; font-size: 11px; font-weight: 600; text-transform: uppercase; margin-top: auto; }
        .btn-add:hover { background: var(--gold); }
    </style>
</head>
<body>
<header class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-gray-100 p-6 text-center">
    <h1 class="serif text-3xl tracking-tighter">LUARY <span class="text-[#c5a059]">SHOP</span></h1>
    <div class="flex justify-center gap-6 mt-4">
        <button onclick="carregarInicio()" class="text-[11px] font-bold uppercase hover:text-[#c5a059]">Início</button>
        <a href="carrinho.html" class="text-[11px] font-bold uppercase text-[#c5a059]">Meu Pedido (<span id="cart-total">R$ 0,00</span>)</a>
    </div>
</header>
<main class="max-w-7xl mx-auto p-6">
    <h2 id="main-h2" class="serif text-2xl text-center my-10">Coleções Exclusivas</h2>
    <div id="grid-content" class="grid grid-cols-2 md:grid-cols-4 gap-6"></div>
</main>

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyD62Yef2ggoAFSc-qKPlBTaRPRn20D91ug",
        databaseURL: "https://luary-shop-default-rtdb.firebaseio.com"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const fM = (v) => v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

    function carregarInicio() {
        document.getElementById('main-h2').innerText = "Nossas Coleções";
        db.ref('categories').on('value', snap => {
            const grid = document.getElementById('grid-content');
            grid.innerHTML = '';
            snap.forEach(s => {
                const cat = s.val();
                grid.innerHTML += `<div class="card-luary cursor-pointer" onclick="verProdutos('${s.key}', '${cat.name}')">
                    <div class="img-box"><img src="${cat.image || 'https://via.placeholder.com/400'}"></div>
                    <div class="p-4 text-center"><h3 class="serif text-lg">${cat.name}</h3></div>
                </div>`;
            });
        });
    }

    function verProdutos(catId, catName) {
        document.getElementById('main-h2').innerText = catName;
        db.ref('products').once('value', snap => {
            const grid = document.getElementById('grid-content');
            grid.innerHTML = '';
            snap.forEach(s => {
                const p = s.val();
                if(p.category === catId) {
                    grid.innerHTML += `<div class="card-luary p-4">
                        <div class="img-box mb-4"><img src="${p.image}"></div>
                        <h3 class="text-xs font-semibold mb-2">${p.name}</h3>
                        <p class="text-sm font-bold text-[#c5a059] mb-4">${fM(p.price)}</p>
                        <button onclick='addCart(${JSON.stringify({...p, id: s.key})})' class="btn-add">Adicionar</button>
                    </div>`;
                }
            });
        });
    }

    function addCart(p) {
        let cart = JSON.parse(localStorage.getItem('luary_cart') || '[]');
        cart.push(p);
        localStorage.setItem('luary_cart', JSON.stringify(cart));
        atualizarTotal();
        alert("Adicionado ao carrinho!");
    }

    function atualizarTotal() {
        const cart = JSON.parse(localStorage.getItem('luary_cart') || '[]');
        const total = cart.reduce((acc, item) => acc + parseFloat(item.price), 0);
        document.getElementById('cart-total').innerText = fM(total);
    }

    window.onload = () => { carregarInicio(); atualizarTotal(); };
</script>
</body>
</html>
